{{InfoBox stack
|{{InfoBox wikipedia|Media Transfer Protocol|header=true}}
}}
'''MTP''' ('''M'''edia '''T'''ransfer '''P'''rotocol) is a protocol to allow the transfer of files to external devices.

== MTPfs ==

=== Installation ===
Install {{Package|sys-fs/mtpfs}}:
{{USEflag|package=sys-fs/mtpfs
|debug
|mad
}}

{{Emerge|mtpfs}}

=== Configuration ===
Your user needs to be in the "plugdev" group:
{{RootCmd|gpasswd -a YOUR_USER plugdev}}

Modify your {{Path|/etc/fuse.conf}}:
{{File|/etc/fuse.conf||<pre>
user_allow_other
</pre>}}

=== Usage ===
* [[Mount]]:
: {{Cmd|mkdir ~/AndroidDevice|
  |mtpfs -o allow_other ~/AndroidDevice}}
: {{Note|Be patient, as this can take several minutes. Upon successful mount, mtpfs will background itself.}}

* Unmount:
: {{Cmd|fusermount -u ~/AndroidDevice}}

== Go-mtpfs ==
{{Note|Newer Galaxy Devices (S3, S4, Note2, etc.) use their own MTP-stack and don't work reliably, although this should be fixed in newer versions. See [https://github.com/hanwen/go-mtpfs/issues/29 Bug#29]}}

=== Installation ===
Install {{Package|sys-fs/go-mtpfs}}:

We need to unmask 2 packages in {{Path|/etc/portage/package.keywords}}:
{{File|/etc/portage/package.keywords||<pre>
dev-libs/go-fuse **
sys-fs/go-mtpfs **
</pre>}}

{{Emerge|go-mtpfs}}

=== Configuration ===
Your user needs to be in the "plugdev" group:
{{RootCmd|gpasswd -a YOUR_USER plugdev}}

=== Usage ===
* [[mount]]:
: {{Cmd|mkdir ~/AndroidDevice|
  |~/go/bin/go-mtpfs ~/AndroidDevice &}}

Note: If you don't run go-mtpfs in the background (with & at the end), you will need another console to browse the device and to unmount it.

* unmount:
: {{Cmd|fusermount -u ~/AndroidDevice}}

When you unmount the device, go-mtpfs will quit.

== gphotofs ==
gphotofs is a FUSE file system for interfacing with digital cameras using gphoto2. Most modern mobile phones are cameras at the same time, and gphotofs can be a good alternative to tmpfs or go-mtpfs.

=== Installation ===
Install {{Package|media-gfx/gphotofs}}:

=== Usage ===
* [[mount]]:
: {{Cmd|mkdir ~/AndroidDevice|
  |gphotofs ~/AndroidDevice -o alllow_other}}

* unmount:
: {{Cmd|fusermount -u ~/AndroidDevice}}

== simple-mtpfs ==
Another FUSE file system implementation for use with MTP devices is simple-mtpfs.

=== Installation ===
Install {{Package|sys-fs/simple-mtpfs}}:

=== Usage ===
* [[mount]]:
: {{Cmd|mkdir ~/AndroidDevice|
  |simple-mtpfs ~/AndroidDevice}}

* unmount:
: {{Cmd|fusermount -u ~/AndroidDevice}}

== KDE ==
'''kio-mtp''' is a slave for [[KDE]]'s KIO framework.

As kio-mtp is still unstable, but is now part of main repository. Then:
{{RootCmd|echo kde-misc/kio-mtp >> /etc/portage/package.accept_keywords}}
{{Emerge|kio-mtp}}

Finally quit KDE, and relaunch it. Now your MTP devices appear e.g. in Dolphin.

== gMTP ==
'''gMTP''' is a simple MTP client for Solaris and Linux.

It is just to install and run {{Package|media-sound/gmtp}}:

{{Emerge|gmtp}}
{{Cmd|gmtp}}

Click on connect. A few second later, you will get the file hierarchy of your device. You can start to manipulate the files. It support features like Album Artwork and play lists.

== adb ==
I am a newbie with an Android phone, and it look like the ones that know are very tired to answer the same questions again and again. That imply it took me hours and even days to find what is possible and not possible to do with a non rooted device. In short, with a non rooted device, the only things you can backup locally is what the couple device/android will let you do. That is pretty much the same files you can copy with the already mentioned software. With the Android 4.x devices, a nice solution to make such a partial backup is the so-called [https://android.stackexchange.com/questions/28296/full-backup-of-non-rooted-devices/28315#28315 "adb backup"].

On gentoo, You can install '''adb''' with portage. '''adb''' mean Android Debug Bridge.

{{Emerge|android-sdk-update-manager}}
{{RootCmd|android}}

When it is done, you can backup the files with
{{Cmd|<nowiki>adb backup [-f <file>] [-apk|-noapk] [-shared|-noshared] [-all] [-system|nosystem] [<packages...>]</nowiki>}}
where
* -f : the path of the *.ab file that will be saved on your computer. This file is a compressed file that contains an archive of the data/apks from your device.
* -apk|-noapk : indicates if the *.apk files should be backed up (default is -noapk)
* -shared|-noshared: enable/disable backup of the device's shared storage / SD card contents (default is -noshared)
* -all : indicates that you want the entire system backed up. you can use the packages filter to just backup specific packages, or use -all for a full system backup.
* -system|-nosystem: indicates if all the system applications and data are included when backing up. (default is -system)
* <packages> : this is where you can list specific packages to backup. Use these if you want to back up only specific applications. If using -all, you do not need to specify packages.

To backup the phone into '''~/HTC_backup''' :
{{Cmd|cd ~}}
{{Cmd|mkdir HTC_backup}}
{{Cmd|adb devices}}
will start the daemon and show you the devices on the USB.
{{Cmd|adb backup -apk -shared -all -system -f ~/HTC_backup/backup<date_of_the_day>.ab}}
will backup every thing the device will let you to backup.
{{Cmd|adb restore ~/HTC_backup/backup<date_of_the_day>.ab}}
will restore the backup into the device.

To stop the daemon:
{{Cmd|adb kill-server}}

== Troubleshooting ==
* If your device is not recognized by libmtp, try upgrading to latest (or even live) version.
* Sometimes (e.g. on HTC One X) USB debugging automatically turns on when device is connected to PC. You need to turn debugging off, otherwise libmtp can't recognize device.
* Make sure your Android device is not going to sleep and the screen is not getting locked. Set screen timeout to very long values, or enable in Development section flag "Do not turn off the screen".

[[Category:Software]]
