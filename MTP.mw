{{InfoBox stack
|{{InfoBox wikipedia|Media Transfer Protocol|header=true}}
}}
'''MTP''' ('''M'''edia '''T'''ransfer '''P'''rotocol) is a protocol to allow the transfer of files to external devices.

== MTPfs ==

=== Installation ===
Install {{Package|sys-fs/mtpfs}}:
{{USEflag|package=sys-fs/mtpfs
|debug
|mad
}}

{{Emerge|mtpfs}}

=== Configuration ===
Your user needs to be in the "plugdev" group:
{{RootCmd|gpasswd -a YOUR_USER plugdev}}

Modify your {{Path|/etc/fuse.conf}}:
{{File|/etc/fuse.conf||<pre>
user_allow_other
</pre>}}

=== Usage ===
* [[Mount]]:
: {{Cmd|mkdir ~/AndroidDevice|
  |mtpfs -o allow_other ~/AndroidDevice}}
: {{Note|Be patient, as this can take several minutes. Upon successful mount, mtpfs will background itself.}}

* Unmount:
: {{Cmd|fusermount -u ~/AndroidDevice}}

== Go-mtpfs ==
{{Note|Newer Galaxy Devices (S3, Note2 and similar) use an own MTP-stack and don't work reliable, although this should be fixed in newer versions. See [https://github.com/hanwen/go-mtpfs/issues/29 Bug#29]}}

=== Installation ===
Install {{Package|dev-lang/go}}:
{{USEflag
|bash-completion
|emacs
|vim-syntax
|zsh-completion
}}

{{Emerge|go}}

Then install Go-mtpfs:
{{Cmd|mkdir ~/go
|export GOPATH{{=}}/home/$USER/go
|go get github.com/hanwen/go-mtpfs
}}

=== Configuration ===
Your user needs to be in the "plugdev" group:
{{RootCmd|gpasswd -a YOUR_USER plugdev}}

=== Usage ===
* [[mount]]:
: {{Cmd|mkdir ~/AndroidDevice|
  |~/go/bin/go-mtpfs ~/AndroidDevice}}

* unmount:
: {{Cmd|fusermount -u ~/AndroidDevice}}

== KDE ==
'''kio-mtp''' is a slave for [[KDE]]'s KIO framework.

As kio-mtp is still unstable, it is only part of [[KDE/Overlay|''kde'' overlay]], which you need to setup first. Then:
{{RootCmd|echo kde-misc/kio-mtp >> /etc/portage/package.accept_keywords}}
{{Emerge|kio-mtp}}

Finally quit KDE, and relaunch it. Now your MTP devices appear e.g. in Dolphin.

== Troubleshooting ==
* If your device is not recognized by libmtp, try upgrading to latest (or even live) version.
* Sometimes (e.g. on HTC One X) USB debugging automatically turns on when device is connected to PC. You need to turn debugging off, otherwise libmtp can't recognize device.
* Make sure your Android device is not going to sleep and the screen is not getting locked. Set screen timeout to very long values, or enable in Development section flag "Do not turn off the screen".

[[Category:Software]]
