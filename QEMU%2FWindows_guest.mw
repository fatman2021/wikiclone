This article describes the setup of a Windows guest using [[QEMU]].

== Host ==
To create a disk image for the virtual machine, run:
{{Cmd|qemu-img create -f qcow2 WindowsVM.img 15G}}

Download Windows driver image from [http://alt.fedoraproject.org/pub/alt/virtio-win/latest/images/bin/ http://alt.fedoraproject.org/pub/alt/virtio-win/latest/images/bin/].

Since QEMU requires a lot of [[QEMU/Options|options]], it would be a good idea to put them into a shell script, e.g.:
{{File|WindowsVM||<pre>
#!/bin/sh
exec qemu-kvm \
        -cpu host \
        -drive file=WindowsVM.img,if=virtio \
        -net nic -net user,hostname=windowsvm \
        -m 1G \
        -monitor stdio \
        -name Windows \
        "$@"
</pre>}}

Change the path to your disk image ''WindowsVM.img'' in the script. You can additional options when calling the script. To boot the disk image, run:
{{Cmd|./WindowsVM -boot d -drive file{{=}}WINDOWS.iso,media{{=}}cdrom -drive file{{=}}DRIVER.iso,media{{=}}cdrom}}

Install the Windows guest. See the [[#Guest|guest section]] for optimum support. After the installation start the script without the additional options.

{{Note|When upgrading to QEMU 1.3 you have to add the option "-enable-kvm" to keep your guest responsive. You also need to change "-net nic" to "-net nic,model{{=}}rtl8139" to have a network interface in your guest.}}
{{Note|When upgrading to QEMU 1.5.3 you have to add "-display sdl,frame{{=}}off,window_close{{=}}off" to keep your fullscreen session full screen. Without this option I got a (new) menubar at the top of the screen, pushing the Windows bottom menu off screen.}}

== Guest ==
* During installation at the partition step Windows doesn't detect the VirtIO hard drive. You have to tell Windows to use the ''viostor'' driver from the driver image.

* After installation Windows doesn't for the VirtIO ethernet adapter. You have to tell Windows to use the ''netkvm'' driver from the driver image.

[[Category:Virtualization]]
