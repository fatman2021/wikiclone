<languages />

Cet article décrit la configuration et l'installation du [[Kernel|Noyau Linux]].

== Mettre en place le lien symbolique ==

Le lien symbolique {{Path|/usr/src/linux}} devrait toujours pointer sur les sources du noyau en cours d'utilisation. Ceci peut être obtenu de trois manières différentes :

; 1. Installer les sources du noyau avec  l'[[option de la variable USE]] ''symlink'' activée.
: Ceci fera que le lien {{Path|/usr/src/linux}} pointera sur vos sources du noyau nouvellement installées. Si nécessaire, il peut encore être modifié avec l'une des deux méthodes suivantes :

; 2. Mettre en place le lien symbolique avec  '''eselect''':

: {{RootCmd| eselect kernel list |
  |output=Available kernel symlink targets:<br/> &nbsp; [1] linux-3.3.8-gentoo *<br/> &nbsp; [2] linux-3.4.9-gentoo
}}

: Ceci affiche les sources du noyau disponibles. L'astérisque indique les sources sélectionnées. Pour les changer, par exemple pour choisir celles correspondant à la deuxième entrée, faites :

: {{RootCmd|eselect kernel set 2}}

; 3. Mettre en place le lien symbolique à la main :

: {{RootCmd|ln -sf /usr/src/linux-3.4.9-gentoo /usr/src/linux |
  |ls -l /usr/src/linux |
  |output=lrwxrwxrwx 1 root root 11 Aug 29 22:10 /usr/src/linux -> /usr/src/linux-3.4.9-gentoo}}
<!-- The output is the same as the target file in the ln command. -->

== Outils de configuration ==

Le noyau dispose de plusieurs outils pour sa configuration :

; '''make config'''
: Une configuration textuelle. Une invite de saisie est présentée une option après l'autre. Toutes les options attendent une réponse, un accès dans le désordre à des options déjà présentées n'est pas possible.

; '''make menuconfig'''
: Menu graphique (saisies textuelles seulement). Vous pouvez naviguer à travers les menus et modifier les options que vous voulez.

; '''make nconfig'''
: Menu graphique basé sur ncurses. Il nécessite le paquet {{Package|sys-libs/ncurses}}qui doit donc être installé.

; '''make xconfig'''
: Memu graphique utilisant Qt4. Il nécessite le paquet {{Package|dev-qt/qtgui}} qui doit donc être installé.

; '''make gconfig'''
: Meru graphique utilisant  GTK+. Il nécessite les paquets {{Package|x11-libs/gtk+}}, {{Package|dev-libs/glib}} et {{Package|gnome-base/libglade}} qui doivent donc être installés.

; '''make oldconfig'''
: Passe les changements entre versions du noyau en revue et met à jour pour créer un nouveau fichier .config pour le noyau.


Il existe aussi plusieurs scripts pour créer diverses configuration par défaut. Reportez-vous à :

{{RootCmd|make help}}

== Configuration ==

Cet aricle décrit la configuration à partir de '''make menuconfig''', mais la procédure est similaire à celle des autres menus.

{{RootCmd|cd /usr/src/linux
|make menuconfig}}

=== Utilisation ===

Dans le menu présenté, la barre bleue indique votre position courante. À l'aide des touches de direction {{Key|up}} et {{Key|down}} vous pouvez changer la position. Les touches de direction {{Key|left}} et {{Key|right}} vous permettent de parcourir la barre de menu en bas et définissent ce qui se passe quand vous frappez la touche {{Key|Enter}}. '''Select''' commute vers un sous-menu - les entrées du menu se terminant par « --> » -, alors que '''Exit''' permet de quitter un sous-menu. En alternative, vous pouvez faire deux fois  {{Key|Esc}}.

Les entrées de menu qui commencent par des parenthèses, crochets, accolades ou similaires, sont des pilotes ou des fonctionnalités que peuvent être activées :

; [ ], [*]
: Les options entre crochets carrés peuvent être activées ou désactivées. L'astérisque indique que l'option est activée. Vous pouvez changer la valeur avec la touche  {{Key|space}} ou en pressant la touche {{Key|Y}} ('''Y'''es ) pour activer ou la touche {{Key|N}} ('''N'''o) pour désactiver l'entrée.
: Si l'option est activée, le pilote choisi sera compilé dans le noyau et sera toujours disponible au démarrage.

; < >, <M>, <*>
: Les options entre crochets anguleux peuvent être activées ou désactivées, mais aussi activées sous forme de module (indiqué par  ''M''). Vous pouvez changer la valeur comme précédemment et presser la touche{{Key|M}} pour l'activer en tant que module.
: Reportez-vous à l'article [[Kernel Modules]] pour en savoir plus.

; {M}, {*}
: Les options entre accolades peuvent être activées ou désactivées en tant que module mais pas totalement désactivées car d'autres pilotes ont besoin qu'elles soient activées d'une manière ou d'une autre.

; -M-, -*-
: Les options entre tirets sont activées, de la manière indiquée, par un autre pilote. Il n'y a pas de possibilité de choisir.


De plus, certaines entrées du menu possèdent une marque à la fin :

; (NEW)
: Ce pilote est nouveau dans le noyau et n'est peut-être pas tout à fait stabilisé.

; (EXPERIMENTAL)
: Ce pilote est expérimental et très probablement insuffisamment stable.

; (DEPRECATED)
: Ce pilote est déconseillé car en voie d'obsolescence et n'est pas nécessaire pour la plupart des systèmes.

; (OBSOLETE)
: This driver is obsolete and should not be activated.


La plupart des options possèdent une description, que l'on peut obtenir en pressant la touche {{Key|H}} ou en choisissant  '''Help''' dans la barre de menu.

=== Sélection du pilote===

See the [[hardware detection]] article and the articles in the [[:Category:Hardware|Hardware]] category.

=== Search modules ===
Within ''menuconfig'', you can use {{Key|/}} to search modules by keyboards.

== Compilation/construction ==

After configuring the kernel you have to compile the kernel:

{{RootCmd|make}}

If you have a processor with multiple cores, you can let all the cores do the work. For this add the parameter '''-j(NUMBER_CORES +1)'''. For a dual core processor:

{{RootCmd|make -j3}}

== Setup ==

If activated drivers as modules, you have to install them:

{{RootCmd|make modules_install}}

The modules will be copied to a sub directory of {{Path|/lib/modules}}.

To install the actual kernel:

{{RootCmd|make install}}

This command executes '''/sbin/installkernel''', which is part of the {{Package|sys-apps/debianutils}} package. ''The new kernel is installed into {{Path|/boot//vmlinuz-{version}}}. If a symbolic link {{Path|/boot/vmlinuz}} already exists, it is refreshed by making a link from {{Path|/boot/vmlinuz}} to the new kernel, and the previously installed kernel is available as {{Path|/boot/vmlinuz.old}}.'' (''installkernel'' [[man page]]). The same for {{Path|config}} and {{Path|System.map}} files. These symlinks are handy, because they point always to the newest kernel without changing the file path (e.g. you can use them in the bootloader configuration).

== Bootloader ==

Change your [[bootloader]] configuration to pick up at boot the new kernel.

Finally restart your system with the new kernel.

[[Category:Kernel]]
