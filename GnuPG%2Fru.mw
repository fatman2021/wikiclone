<languages />


{{Metadata|abstract=Это небольшое руководство научит Вас основам использования GnuPG, инструмента для защищенной передачи сообщений.}}

Это небольшое руководство научит Вас основам использования GnuPG, инструмента для защищенной передачи сообщений.

== Введение ==

=== О чем будет рассказано в этом руководстве ===

Это руководство предполагает, что вы знакомы с криптографией с открытым ключом, шифрованием и цифровыми подписями. Если это не так, посмотрите главу 2 [http://www.gnupg.org/documentation/guides.html настольной книги GnuPG] и возвращайтесь обратно. 

Это руководство научит Вас как установить GnuPG, создать свою ключевую пару, добавить ключи в связку, отправить свой открытый ключ на сервер ключей, а также как подписывать, шифровать, проверять или расшифровывать сообщения, отправленные или полученные Вами. Вы также научитесь шифровать файлы на своем локальном компьютере, чтобы предотвратить чтение их содержимого посторонними людьми.

=== Установка требуемых программ ===

На самом простом уровне, Вам потребуется запустить <kbd>emerge gnupg</kbd> . На сегодняшний день, множество приложений имеют тот или иной вид поддержки gpg, поэтому добавка <code>crypt</code> в список Ваших переменных USE, возможно, является хорошей идеей. Если Вы хотите иметь email client с возможностью использования gnupg, Вы можете использовать pine (<kbd>emerge pinepgp</kbd>), mutt (<kbd>emerge mutt</kbd>), Mozilla Thunderbird (<kbd>emerge thunderbird</kbd>), evolution (evolution - это GNOME-близнец Microsoft Outlook со схожими принципами работы) и принадлежащий KDE Kmail (<kbd>emerge kde-base/kmail</kbd>). 

Installing Kgpg (<kbd>emerge kde-base/kgpg</kbd>) might interest you if you use KDE. This small program allows you to generate key pairs, import keys from ASCII files, sign imported keys, export keys and a few more features.

== Генерация ключа и добавление в связку открытых ключей ==

=== Создание ключа ===

To create your key, just run <kbd>gpg --gen-key</kbd>. The first time you run it, it will create some directories; run it again to create the keys: 

{{Cmd|gpg --gen-key|output=<pre>
gpg (GnuPG) 1.0.7; Copyright (C) 2002 Free Software Foundation, Inc.
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions. See the file COPYING for details.
  
Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
   Your selection? 1
</pre>
}}

Здесь Вы можете выбрать тип ключа, который Вы хотите использовать. Большинство пользователей предпочтут алгоритмы по умолчанию: RSA и RSA. Далее идет размер ключа. Запомните, что чем больше, тем лучше, но не используйте размер больший чем 2048 с ключами DSA/ElGamal. В основном, 2048 более чем достаточно для обычной почты. 

После размера следует дата истечения срока действия ключа. В этом случае, чем меньше, тем лучше, но большинство пользователей может предпочесть ключ, который никогда не истекает, или обладает сроком действия в 2 или 3 года. 

{{CodeBox|title=Choosing key size|<nowiki>
RSA keypair will have 1024 bits.
RSA keys may be between 1024 and 4096 bits long.
    What keysize do you want? (2048) 2048
Requested keysize is 2048 bits       
Please specify how long the key should be valid.
         0 = key does not expire
 <n>= key expires in n days
 <n>w = key expires in n weeks
 <n>m = key expires in n months
 <n>y = key expires in n years
 Key is valid for? (0) 0
Key does not expire at all
</nowiki>}}

А теперь пришло время ввести личную информацию. Если Вы собираетесь отправить открытый ключ другим людям, Вам нужно использовать Ваш действительный email адрес: 

{{CodeBox|title=Entering user information|
Is this correct (y/n)? y
                          
GnuPG needs to construct a user ID to identify your key.
  
Real name: John Doe
Email address: john@nowhere.someplace.flick
Comment: The Real John Doe
You selected this USER-ID:
"John Doe (The Real John Doe) <john@nowhere.someplace.flick>"
  
Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O 
You need a Passphrase to protect your secret key.    
  
Enter passphrase: 
}}

Теперь, введите Вашу парольную фразу дважды. Хорошей идеей является использование сильного пароля. Если кто-либо когда-нибудь овладеет Вашим закрытым ключом и взломает Ваш пароль, они будут способны отправлять сообщения подписанные ''Вами'', заставляя всех поверить, что письма были отправлены Вами на самом деле. 

Далее, GnuPG сгенерирует Ваш ключ. Двигание мышкой или проигрывание mp3 на заднем плане поможет ускорить процесс, потому что это генерирует случайные данные. 

=== Генерация сертификата отзыва ===

{{Important/ru|Эта часть очень важна и Вы должны сделать это ''СЕЙЧАС''.}}

После создания Ваших ключей Вы должны создать сертификат отзыва. Выполнение этого позволит Вам отозвать Ваш ключ в случае если с Вашим ключом произойдет что-то неприятное (кто-либо завладеет Вашим ключом/парольной фразой). 

{{Cmd|gpg --list-keys|output=<pre>
/home/humpback/.gnupg/pubring.gpg
---------------------------------
pub  1024D/75447B14 2002-12-08 John Doe (The Real John Doe) <john@nowhere.someplace.flick>
sub  2048g/96D6CDAD 2002-12-08
</pre>}}

{{Cmd|gpg --output revoke.asc --gen-revoke 75447B14|output=<pre>
sec  1024D/75447B14 2002-12-08   John Doe (The Real John Doe) <john@nowhere.someplace.flick>
  
Create a revocation certificate for this key? y
Please select the reason for the revocation:   
  0 = No reason specified
  1 = Key has been compromised
  2 = Key is superseded
  3 = Key is no longer used
  Q = Cancel
(Probably you want to select 1 here)
Your decision? 1
Enter an optional description; end it with an empty line:
> Someone cracked me and got my key and passphrase
>
Reason for revocation: Key has been compromised
Someone cracked me and got my key and passphrase
Is this okay? y
  
You need a passphrase to unlock the secret key for
user: "John Doe (The Real John Doe) <john@nowhere.someplace.flick>"
1024-bit DSA key, ID 75447B14, created 2002-12-08
  
ASCII armored output forced.
Revocation certificate created.
  
Please move it to a medium which you can hide away; if Mallory gets
access to this certificate he can use it to make your key unusable.
It is smart to print this certificate and store it away, just in case
your media become unreadable.  But have some caution:  The print system of
your machine might store the data and make it available to others!
</pre>
}}

The <kbd>gpg --list-keys</kbd> command lists keys in your public keyring. You may use it to see the ID of your key so that you can create the revocation certificate. Now it is a good idea to copy all the .gnupg directory and the revocation certificate (in ASCII armor - {{Path|revoke.asc}}) to some secure medium (two floppy's or a CD-R you store in safe location). Remember that {{Path|revoke.asc}} can be used to revoke your keys and make them unusable in the future. 

{{Note|If you have several email addresses that you would like to use with this key, you can run <kbd>gpg --edit-key YOUR_ID</kbd> and then use the <kbd>adduid</kbd> command. It will ask you for the name, email and comment of the second ID you will be using.}}

=== Экспорт ключей ===

To export your key, you type <kbd>gpg --armor --output john.asc --export john@nowhere.someplace.flick</kbd>. You can almost always use the key ID or something that identifies the key (here we used an email address). John now has a {{Path|john.asc}} that he can send his friends, or place on his web page so that people can communicate safely with him. 

=== Импорт ключей ===

Чтобы добавить файлы в свою связку открытых ключей, Вы должны сперва их импортировать, а затем проверить отпечаток ключа. После того как Вы проверили отпечаток, Вы должны его подтвердить. 

{{Note/ru|Вы должны быть осторожны при проверке ключей. Это одно из слабых мест криптографии с открытым ключом.}}

Now we will be adding Luis Pinto's (a friend of mine) public key to our public keyring. After giving him a call and asking him for his key fingerprint, I compare the fingerprint with the output of the <kbd>fpr</kbd> command. As the key is authentic, I add it to the public keyring. In this particular case, Luis's key will expire in 2003-12-01 so I am asked if I want my signature on his key to expire at the same time. 

{{Cmd|gpg --import luis.asc|output=<pre>
gpg: key 462405BB: public key imported
gpg: Total number processed: 1
gpg:               imported: 1
</pre>}}

{{Cmd|gpg --list-keys|output=<pre>
/home/humpback/.gnupg/pubring.gpg
---------------------------------
pub  1024D/75447B14 2002-12-08 John Doe (The Real John Doe) <john@nowhere.someplace.flick>
sub  2048g/96D6CDAD 2002-12-08
  
pub  1024D/462405BB 2002-12-01 Luis Pinto <lmpinto@student.dei.uc.pt>
uid                            Luis Pinto <lmpinto@dei.uc.pt>
sub  4096g/922175B3 2002-12-01 [expires: 2003-12-01]
</pre>}}

{{Cmd|gpg --edit-key lmpinto@dei.uc.pt|output=<pre>
gpg (GnuPG) 1.0.7; Copyright (C) 2002 Free Software Foundation, Inc.
This program comes with ABSOLUTELY NO WARRANTY.
This is free software, and you are welcome to redistribute it
under certain conditions. See the file COPYING for details.
  
gpg: checking the trustdb
gpg: checking at depth 0 signed=0 ot(-/q/n/m/f/u)=0/0/0/0/0/1
pub  1024D/462405BB  created: 2002-12-01 expires: 2003-12-01 trust: -/-
sub  4096g/922175B3  created: 2002-12-01 expires: 2003-12-01
(1)  Luis Pinto <lmpinto@dei.uc.pt>
(2). Luis Pinto <lmpinto@student.dei.uc.pt>
</pre>}}

{{Cmd|fpr|prompt=Command> |output=<pre>
pub  1024D/462405BB 2002-12-01 Luis Pinto <lmpinto@dei.uc.pt>
             Fingerprint: F056 3697 ADE3 CF98 B80B  8494 0AD3 E57B 4624 05BB
</pre>}}

{{Cmd|sign|prompt=Command> |output=<pre>
Really sign all user IDs? y
                           
pub  1024D/462405BB  created: 2002-12-01 expires: 2003-12-01 trust: -/-
             Fingerprint: F056 3697 ADE3 CF98 B80B  8494 0AD3 E57B 4624 05BB
  
     Luis Pinto <lmpinto@dei.uc.pt>
     Luis Pinto <lmpinto@student.dei.uc.pt>
  
This key is due to expire on 2003-12-01.
Do you want your signature to expire at the same time? (Y/n) Y
How carefully have you verified the key you are about to sign actually belongs
to the person named above?  If you don't know what to answer, enter "0".
  
   (0) I will not answer. (default)
   (1) I have not checked at all.
   (2) I have done casual checking.
   (3) I have done very careful checking.
  
   Your selection? 3
Are you really sure that you want to sign this key
with your key: "John Doe (The Real John Doe) <john@nowhere.someplace.flick>"
  
I have checked this key very carefully.
  
Really sign? y
              
You need a passphrase to unlock the secret key for
user: "John Doe (The Real John Doe) <john@nowhere.someplace.flick>"
1024-bit DSA key, ID 75447B14, created 2002-12-08
</pre>}}

{{Cmd|check|prompt=Command> |output=<pre>
uid  Luis Pinto <lmpinto@dei.uc.pt>
sig!3       462405BB 2002-12-01   [self-signature]
sig!3       75447B14 2002-12-08   John Doe (The Real John Doe) <john@nowhere.someplace.flick>
uid  Luis Pinto <lmpinto@student.dei.uc.pt>
sig!3       462405BB 2002-12-01   [self-signature]
sig!3       75447B14 2002-12-08   John Doe (The Real John Doe) <john@nowhere.someplace.flick>
</pre>
}}

== Обмен ключами с серверами ключей ==

=== Отправка ключей на сервер ===

Now that you have your key, it is probably a good idea to send it to the world key server. There are a lot of keyservers in the world and most of them exchange keys between them. Here we are going to send John Doe's key to the keys.gnupg.net server. This uses HTTP, so if you need to use a proxy for HTTP traffic don't forget to set it (<kbd>export http_proxy=<nowiki>http://proxy_host:port/</nowiki></kbd>). The command for sending the key is: <kbd>gpg --keyserver keys.gnupg.net --keyserver-options honor-http-proxy --send-key 75447B14</kbd> where ''<tt>75447B14</tt>'' is the key ID. If you don't need a HTTP proxy you can remove the ''<tt>--keyserver-options honor-http-proxy</tt>'' option. 

Вы также можете отправить ключи других людей, которые Вы подписали, на сервер ключей. Мы можем отправить ключ Луиса Пинто на сервер. Таким образом, кто-нибудь кто доверяет Вашему ключу, может использовать подпись, которую Вы там разместили, для того чтобы доверять ключу Луиса. 

=== Получение ключей с сервера ===

Теперь мы собираемся найти ключ Gustavo Felisberto и добавить его в связку ключей John Doe (на случай, если Вы не заметили, Gustavo Felisberto - автор этого руководства :&#41;). 

{{Cmd|gpg --keyserver keys.gnupg.net --keyserver-options honor-http-proxy --search-keys humpback@felisberto.net|output=<pre>
gpg: searching for "humpback@felisberto.net" from hkp server keys.gnupg.net
(1)	Gustavo Felisberto <humpback@gmail.com>
	Gustavo Felisberto <humpback@gentoo.org>
	Gustavo Felisberto <humpback@gentoopt.org>
	Gustavo Felisberto <gustavo@felisberto.net>
	Gustavo Felisberto <humpback@gentoo-pt.org>
	Gustavo Felisberto <humpback@felisberto.net>
	Gustavo Felisberto <gustavo@student.dei.uc.pt>
	Gustavo Felisberto <humpback@student.dec.uc.pt>
	Gustavo Felisberto (apt-get install anarchy) <humpback@felisberto.net>
	  1024 bit DSA key B9F2D52A, created: 2002-12-06
(2)	Gustavo Adolfo Silva Ribeiro Felisberto <humpback@altavista.net>
	  1024 bit DSA key 26471D8F, created: 2001-09-05
(3)	Gustavo Felisberto <humpback@altavista.net>
	  1024 bit DSA key E97E0B46, created: 1999-08-04, expires: 2000-08-04 (expired)
(4)	Gustavo A.S.R. Felisberto <humpback@altavista.net>
	  1024 bit DSA key B59AB043, created: 1998-12-10
(5)	Gustavo Adolfo Silva Ribeiro Felisberto <humpback@altavista.net>
	  1024 bit DSA key 39EB133D, created: 1998-08-27
(6)	Gustavo Adolfo Silva Ribeiro Felisberto <humpback@altavista.net>
	  1024 bit DSA key AE02AF87, created: 1998-06-15
Enter number(s), N)ext, or Q)uit > 1
gpg: requesting key B9F2D52A from hkp server keys.gnupg.net
gpg: key B9F2D52A: public key "Gustavo Felisberto <humpback@felisberto.net>" imported
gpg: 3 marginal(s) needed, 1 complete(s) needed, classic trust model
gpg: depth: 0  valid:   4  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 4u
gpg: next trustdb check due at 2015-06-28
gpg: Total number processed: 1
gpg:               imported: 1
</pre>
}}

As you can see from the server response I have a few keys submitted to the key server, but I currently only use ''<tt>B9F2D52A</tt>''. Now John Doe can get it and sign it if he trusts it.

== Использование GPG Agent ==

=== Что такое GPG Agent? ===

Иногда, работа с определенными приложениями требует от Вас очень частого использования ключа GPG. Это означает что Вам придется вводить парольную фразу много раз. Несколько приложений поддерживали механизм кэширования парольной фразы чтобы облегчить жизнь пользователям. Однако, это не позволяло делить этот кэш между программами (насколько это было бы безопасно?) и вынуждало приложения изобретать колесо снова и снова. 

GPG агент - это отдельное приложение, используемое GPG для кэширования парольной фразы стандартным и безопасным способом. Оно позволяет приложениям использовать GPG параллельно: если Вы вводите парольную фразу, работая в одном приложении, другое приложение может работать с GPG без повтора запроса парольной фразы для разблокирования ключа - если, конечно же, GPG агент настроен на то чтобы это разрешить. 

Gentoo предоставляет несколько приложений GPG agent. Пакет {{Package|app-crypt/gnupg}} содержит то, что можно рассматривать как эталон, и будет тем, что мы будем использовать в этом документе.

=== Конфигурация gpg-agent и pinentry ===

GnuPG includes <code>gpg-agent</code>. Pinentry ({{Package|app-crypt/pinentry}}) is a helper application that gpg-agent uses to request the passphrase in a graphical window. It comes in three flavors: it can popup a window using the gtk+, Qt, or curses libraries (depending on the USE flags set in {{Path|/etc/portage/make.conf}}). 

If you installed {{Package|app-crypt/pinentry}} with more than one popup window type, it is possible to choose between them with the <kbd>eselect pinentry</kbd> command: 

{{RootCmd|eselect pinentry list|output=<pre>
Available pinentry implementations:
  [1]   pinentry-gtk-2 *
  [2]   pinentry-curses
  [3]   pinentry-qt4
</pre>}}

{{RootCmd|eselect pinentry set 1}}

Теперь, создайте файл с названием {{Path|~/.gnupg/gpg-agent.conf}} и введите следующие строчки, которые определят срок действия парольной фразы по умолчанию (напр., 30 минут), а также приложение, которое надо вызвать когда парольная фраза должна быть получена в первый раз (напр., gtk+ версия pinentry). 

{{FileBox|filename=~/.gnupg/gpg-agent.conf|
pinentry-program /usr/bin/pinentry-gtk-2
no-grab
default-cache-ttl 1800
}}

Затем, настройте GnuPG на использование agent, когда это уместно. Отредактируйте {{Path|~/.gnupg/gpg.conf}} и добавьте следующую строчку: 

{{FileBox|filename=~/.gnupg/gpg.conf|title=Configuring GnuPG to use a GPG Agent|
use-agent
}}

Теперь Ваша система (почти) настроена на использование GPG agent.

=== Автоматический запуск GPG Agent ===

Если Вы используете KDE в качестве графической среды, отредактируйте {{Path|/etc/kde/startup/agent-startup.sh}} и раскомментируйте следующее (глобально) или добавьте следующую команду в {{Path|~/.kde4/env/gpg-agent.sh}} (для локального пользователя), чтобы KDE автоматически запускал GPG agent: 

{{FileBox|filename=/etc/kde/startup/agent-startup.ksh|title=Make KDE automatically start the GPG agent|lang=bash|1=
eval "$(gpg-agent --daemon)"
}}

Дополнительно, раскомментируйте следующее в {{Path|/etc/kde/shutdown/agent-shutdown.sh}} (глобально) или добавьте в {{Path|~/.kde4/shutdown/gpg-agent.sh}} (для локального пользователя): 

{{FileBox|filename=/etc/kde/shutdown/agent-shutdown.sh|title=Make KDE shut down the GPG agent|lang=bash|1=
if [ -n "${GPG_AGENT_INFO}" ]; then
  kill $(echo ${GPG_AGENT_INFO} {{!}} cut -d':' -f 2) >/dev/null 2>&1
fi
}}

Если Вы используете другую графическую среду, поместите эту строку (ту же, что и упомянутую выше) в {{Path|~/.xinitrc}} (если Вы используете <code>startx</code>) или {{Path|~/.xsession}} (если Вы используете XDM/GDM/KDM/...).

== Работа с документами ==

=== Шифрование и подпись ===

Давайте предположим, что Вы имеете файл, который Вы хотели бы отправить Луису. Вы можете его зашифровать, подписать, или зашифровать и подписать одновременно. Шифрование означает что только Луис сможет его открыть. Подпись говорит Луису о том что Вы действительно тот кто создал этот файл. 

Следующие три команды как раз это и сделают: зашифруют, подпишут и зашифруют/подпишут. 

{{Cmd|gpg --output doc.gpg --encrypt --recipient lmpinto@dei.uc.pt doc_to_encrypt
|gpg --output doc.gpg --sign --recipient lmpinto@dei.uc.pt doc_to_sign
|gpg --output doc.gpg --encrypt --sign --recipient lmpinto@dei.uc.pt doc_to_encrypt_and_sign}}

This will create binary files. If you wish to create ASCII files, just add a <tt>--clearsign</tt> option to the beginning of the command. 

=== Расшифровка и проверка подписей ===

Suppose that you have received a file which is encrypted to you. The command used to decrypt it is <kbd>gpg --output document --decrypt encrypted_doc.gpg</kbd>. This will decrypt the document and verify the signature (if there is one). 

=== Шифрование и расшифровка без ключей ===

It is also possible to encrypt files using passwords instead of keys. Well, the password itself will function as the key - it will be used as a ''symmetric cypher''. You can encrypt the file using <kbd>gpg --symmetric</kbd>; decrypting uses the same command as we talked about before. 

{{Cmd|gpg --output document.gpg --symmetric document}}

GnuPG запросит парольную фразу и ее подтверждение.

=== Расширенные функции ===

В GnuPG есть несколько приятных расширенных функций. Чтобы их найти, откройте файл {{Path|~/.gnupg/gpg.conf}} . 

{{FileBox|filename=~/.gnupg/gpg.conf|
#keyserver x-hkp://keys.gnupg.net
#keyserver-options auto-key-retrieve include-disabled include-revoked
}}

Search for the above two lines and uncomment them. With this any time GnuPG needs to check a signature and it does not find the public key on the local keyring it will contact the key server at [http://keys.gnupg.net:11371/ keys.gnupg.net] and will try to fetch it from there. 

Another nice command is <kbd>gpg --refresh-keys</kbd>. This will contact the keyserver defined in the options file and refresh public keys in your local key ring from there, searching for revoked keys, new IDs, and new signatures on keys. You should probably run this once or twice a month so that if someone revokes his key you will be notified.

== Интерфейсы GnuPG ==

=== О подписях электронной почты ===

95% времени, Вы будете использовать GnuPG в электронной почте, подписывая/шифруя Ваши исходящие сообщения и читая подписанные/зашифрованные сообщения, отправленные Вам. Поэтому будет честно, если я расскажу об этом сначала. 

There are two ways two sign/encrypt a email with GnuPG, the old way and the new way. In the old way messages would appear in plain text, with no possible formatting and attached files would be unsigned/unencrypted. Here is an example of a message signed the old way: 

{{CodeBox|title=A plain text signature|<nowiki>
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
  
Test message
  
-----BEGIN PGP SIGNATURE-----
Version: PGPfreeware 6.5.8 for non-commercial use
  
iQA/AwUBP8461jMX0745gR7AEQIEOwCg011GbufXO3ED3FkLWXmfzg7xm1cAoJD0
0EU3Kd2EKNCqataEqM5qjpPs
=LchZ
-----END PGP SIGNATURE-----
</nowiki>
}}

Сообщения этого рода не имеют смысла в сегодняшнем мире, где мы имеем удобные графические интерфейсы пользователя и программы чтения электронной почты, которые понимают html. 

Для того, чтобы решить эту проблему, к стандарту MIME (Multipurpose Internet Mail Extensions) было создано дополнение. Оно добавило поле в email сообщение, которое сообщает программе чтения почты, что все содержимое этого сообщения подписано и/или зашифровано. Проблема заключается в том, что не все программы чтения почты это поддерживают. И некоторые даже портят содержимое; Microsoft Outlook знаменит своими отказами с этим работать. 

=== Kgpg ===

Kgpg ({{Package|kde-base/kmail}}) is a nice GUI for GnuPG. In the main screen you can paste the text that you wish to sign or encrypt, and you can also paste the ASCII armored text that you wish to decrypt. 

На главном экране Вы можете расшифровать текст (Вам потребуется указать пароль), зашифровать другие файлы, вставить новый текст для подписи....

=== Seahorse ===

Seahorse ({{Package|app-crypt/seahorse}}) aims to be a GnuPG GUI interface for the Gnome desktop. The software has been evolving fast, but it still lacks many important features that can be found in Kgpg or the command line version. 

=== KMail ===

Если у Вас установлен USE-флаг <code>crypt</code>, KMail скомпилируется с поддержкой gpg, и сможет шифровать и расшифровывать встроенные в почту в виде текста сообщения PGP  автоматически, а также шифровать сообщения OpenPGP/MIME. Если Вы также хотите расшифровывать сообщения OpenPGP/MIME (что, скорее всего, так), Вам нужно запустить GPG agent. 

To verify if KMail is properly configured navigate to {{Path|Settings -> Configure KMail -> Security -> Crypto Backends}}. You should see a GpgME-based backend listed and you should be able to fill the OpenPGP checkbox. If it is listed but grayed out, click on {{Path|Rescan}}. If the GpgME-based backend remains grayed out, KMail is not working properly. 

Если у Вас все еще не получается заставить KMail работать должным образом, посмотрите страницу [http://kmail.kde.org/kmail-pgpmime-howto.html Описание KMail PGP] , чтобы получить больше информации. 

=== Claws-Mail ===

This mail reader is ''very'' fast with big mailboxes, has all the nice features one wants in mail readers and works well with gpg. The only problem is that it does not work with the old PGP signatures, so when receiving those kind of mails the signatures must be hand checked. 

To use your gpg key with Claws-Mail navigate to {{Path|account configuration -> privacy tab}}. Once there just choose which key to use, probably most users will go with the default key.

== Криптография с Открытым Ключом ==

=== Введение в Криптографию с Открытым Ключом ===

The concept of public key cryptography was originally devised by Whitfield Diffie and Martin Hellman in 1976. When I first heard the words "public key" and "cryptography" in the same sentence back in '93 I thought to myself that it would be impossible to do such a thing. In those days there was no Internet (well there was, but not for me) so I went to the public library and asked for books on Cryptography. I must say that I was 16 at the time so the clerk there looked to me in astonishment and brought me a book for children on substitution cyphers (those where you change a letter for another like the famous Caesar Cypher or ROT-13 (Tragbb Ebpxf, naq lbh xabj vg vf tbbq orpnhfr lbh ner ernqvat guvf qbp.), (<kbd>emerge rotix</kbd> if you cannot read the preceding text)). I was very upset with this and started to search for more info. It is good to have mathematicians in the family, because as soon as I talked to one of them I was introduced to a new world. 

А теперь немного математики: 

{{CodeBox|title=Mathematical Concepts|<nowiki>
Definitions:
  
1- A prime number is a positive integer number greater than one that is only
divisible by 1 and itself (the remainder of the division is 0).
The first 8 prime numbers are 2,3,5,7,11,13,17,19
  
Theorem (No proof here)
1- For any non prime positive integer it is possible to break it as the product
of prime numbers, and that product is unique.
4=2*2
6=2*3
8=2*4=2*2*2
10=2*5
12=2*6=2*2*3
  
"Facts":
1- It is mathematically easy to multiply two large integers.
2- It is hard to find the prime factors of a given positive integer.
</nowiki>
}}

If I give you the number 35 and I tell you that this number is the product of two prime numbers it is easy to find that it was 5 and 7. But if I tell you the same for 1588522601 you will spend a lot of time (or CPU cycles) to find it was 49811*31891. And if this number is really really big this task becomes "impossible". So now if I give the world my large number that is the product of two primes I know something about that number that no one else knows. 

This is the basis for Public Key Cryptography (PKC) implementations today. As an (unrealistic) example, I give anyone my number and that someone will use if for cyphering a message to me. Anyone can see the cyphered message, because I am the only one who knows a shortcut to read it, anyone else will first have to "split" that big number to be able to read the message, and it is a "fact" that it is impossible to do that in a short amount of time (today's methods and the fastest computers in the world would take thousands of years to do that). In this setup the two large prime numbers would be called the PRIVATE KEY, and the large non prime number is the PUBLIC KEY. 

На практике, это не на 100% точно, но мы дали хорошую идею новичку. За более подробной информацией обратитесь к Википедии - протокол [https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB_%D0%94%D0%B8%D1%84%D1%84%D0%B8_%E2%80%94_%D0%A5%D0%B5%D0%BB%D0%BB%D0%BC%D0%B0%D0%BD%D0%B0 Диффи-Хеллмана] . Чтобы найти еще больше информации, зайдите в библиотеку и возьмите копию [http://www.cacr.math.uwaterloo.ca/hac/ "Handbook of Applied Cryptography"] от Alfred J. Menezes, Paul C. van Oorschot и Scott A. Vanstone. Эта книга также доступна онлайн абсолютно бесплатно на сайте, указанном выше. 

Одним из следствий вышесказанного является то, что если Вы зашифруете мне сообщение и потеряете первоначальное незашифрованное сообщение, Вы больше не сможете получить его из зашифрованной версии.

=== Подписи ===

Мы уже видели как кто-нибудь может отправить нам зашифрованное сообщение, если он обладает нашим открытым ключом. Но как нам узнать, что автором сообщения на самом деле является тот, кто об этом заявляет? Или, другими словами: Если я получаю электронное сообщение от Вас, как мне действительно узнать, что это были Вы, а не кто-то другой, притворяющийся Вами. 

Помните я говорил, что криптография с открытым ключом не настолько проста? Идея заключается в том, что когда Вы зашифровываете сообщение для меня, Вы подписываете его своим закрытым ключом, так, чтобы, когда я его получу, я смог использовать сперва Ваш открытый ключ для проверки подписи, а затем использовать мой закрытый ключ, чтобы расшифровать само сообщение. Как видите, мы не можем этого сделать в сценарии, описанном ранее. 

Также очень важно подписывать сообщения без их шифрования. В этом случае Вы сможете создавать сообщения, которые могут быть прочитаны каждым, но которые идут от Вашего имени. И если любой из символов в сообщении будет изменен, это может быть (и будет) обнаружено. 

=== Сервера Ключей и Подписанные Ключи ===

Но давайте предположим, что я не имел с Вами контакта ранее, до тех пор пока Вы не отправили мне сообщение. Как мне получить Ваш открытый ключ, и как мне узнать, что это действительно Вы? 

Чтобы решить эту проблему, были созданы сервера ключей. Когда вы создаете ключевую пару (открытый и закрытый ключ), Вы отправляете свой открытый ключ на сервер ключей. После этого любой может получить Ваш ключ оттуда. Это решает проблему поиска ключа. Но как же мне на самом деле узнать, что этот ключ является ключом автора сообщения? Для этого должна быть представлена другая идея, и ей является подписание ключей: 

Подписание ключа означает, что если я обладаю открытым ключом другого лица, и я знаю ''наверняка'', что это действительно ключ того самого лица (это мой друг, кто-нибудь, кого я знаю по жизни, и т.д.), я могу подписать этот открытый ключ и отправить его на сервер. Таким образом, я сообщаю миру: "Этот ключ действительно принадлежит тому лицу, которое об этом заявляет.". Люди, которые обладают моим открытым ключом и доверяют мне, могут использовать это для доверия остальным ключам. 

Иногда это может сбить с толку, поэтому давайте рассмотрим реальную ситуацию. 

Давайте представим ситуацию для трех лиц: Антона, Марии и Лизы. Антон дружит с Марией, но не знает Лизу; Лиза дружит с Марией, но не знает Антона. В один день, Лиза отправляет Антону подписанное сообщение. Антон получает открытый ключ Лизы с сервера ключей и тестирует сообщение. Если все прошло успешно, он увидит, что кто-бы ни подписал это сообщение, он также создал и этот ключ. Но как мне узнать, что это на самом деле был тот человек, который заявляет об этом? 

Затем Антон видит, что этот ключ подписан Марией, что он может проверить, потому что он уже обладает ключом Марии и доверяет этому ключу. С этим кольцом доверия, он приходит к выводу, что сообщение, которое было им получено, было на самом деле написано Лизой. 

Теперь Вы готовы использовать это руководство. Вы можете перейти обратно к главе 1 и начать изучать как использовать gpg. 

== Заключительные мысли и Благодарности ==

=== Некоторые из проблем ===

У меня были некоторые проблемы с использованием фото в ключах. Проверьте версию которой Вы пользуетесь. Если у Вас GnuPG 1.2.1-r1 и выше, Вы, вероятно, в порядке. Более старые версии могут иметь проблемы. Также, большинство серверов ключей не работают с ключами с фото, поэтому будет лучше если Вы не станете добавлять фотографии. 

The latest versions of gnupg don't seem to work with the <kbd>gpg --send-keys</kbd> that was used so send all keys in your keyring to the public server. 

=== О чем здесь не написано ===

<code>gpg</code> - очень сложный инструмент. Он позволяет делать гораздо больше, чем то, о чем я здесь написал. Этот документ предназначен для тех пользователей, которые еще не знакомы с GnuPG. За более подробной информацией, обратитесь к [http://www.gnupg.org Вебсайту GnuPG] . 

Я не написал о других инструментах, таких как <code>pgp4pine</code>, <code>gpgpine</code> , <code>evolution</code> и, может быть, инструментах под Windows, но я, возможно, дополню этот документ в дальнейшем.

=== Благодарности ===

[http://www.gnupg.org Настольная Книга GnuPG] от John Michaeil Ashley - очень хорошая книга для новичков. 

Swift (Sven Vermeulen) за подталкивание меня к переписанию этого руководства. 

Каждого из команды #gentoo-doc. Парни, вы рулите. 

Tiago Serra, за мое возвращение обратно на путь конфиденциальности.


[[Category:Server and Security]] {{Migrated|originalauthors=Gustavo Felisberto, John P. Davis, Sven Vermeulen, nightmorph}}
